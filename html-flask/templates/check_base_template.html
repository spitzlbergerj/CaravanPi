<!DOCTYPE html>
<html>
<head>
    <title>CaravanPi - {{ title }}</title>
    {% if next_check_route %}
        <meta http-equiv="refresh" content="1; url={{ url_for(next_check_route) }}">
    {% endif %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/caravanpi.css') }}">
</head>
<body>
    <div class="container">
        <div class="hamburger-menu" onclick="toggleHamburgerMenu()">
            <div></div>
            <div></div>
            <div></div>
        </div>

        <div id="hamburgerMenu" class="hamburger-menu-content">
            <!-- Hamburger-Menü-Links werden per JavaScript hinzugefügt -->
        </div>

        <div class="content">
            <div class="logo">
                <img src="/static/images/CaravanPi-Logo.png" alt="CaravanPi Logo" class="logo">
            </div>
            <hr>

            <p>&nbsp;</p>
            <p>Mit dem Aufruf dieser Website werden eine Reihe von Check-Routinen gestartet, die alle Komponenten des CaravanPi der Reihe nach durchtesten.</p>
            <p>Manche Tests benötigen <b>10 Sekunden und mehr</b>. Bitte haben Sie Geduld.</p>
            <p></p>

            <h1>Prüfung der Komponenten</h1>

                <table>
                    {% for check in check_list %}
                        <tr>
                            <td>{{ check.name }}</td>
                            <td>
                                {% if check.key == current_check %}
                                    ... Prüfung läuft ...
                                {% elif check_results[check.key]['result'] is not none %}
                                    <b><span style="color: {{ check_results[check.key]['color'] }}">{{ check_results[check.key]['result'] }}</span></b>
                                {% else %}
                                    <!-- Leer lassen für Checks, die noch nicht gestartet wurden -->
                                {% endif %}
                            </td>
                                </tr>
                    {% endfor %}
                </table>

                <p>&nbsp;</p>
                {% if not next_check_route %}
                <!-- Button, der zur Startseite umleitet -->
                <div class="logo">
                    <form action="{{ url_for('home') }}" class="logo">
                        <button type="submit" class="finish-button">Abschließen</button>
                    </form>
                </div>
                {% endif %}
    
                <p>&nbsp;</p>
                <p>Weitere Infos zum Projekt CaravanPi finden Sie auf der <a href="https://www.caravanpi.de">CaravanPi-Website</a> und auf <a href="https://github.com/spitzlbergerj/CaravanPi">github</a></p>
        </div>

        <div class="footer">
            <p>&copy; CaravanPi - Josef Spitzlberger - 2024</p>
        </div>
    </div>
    
    <script>
        function populateLinks(menu, includeHome) {
            var host = window.location.hostname;
            var port = window.location.port;

            var links = [
                { text: "Startseite", url: 'http://' + host + ':5000/', isExternal: false },
                { text: "Konfigurationswebsite", url: 'http://' + host + ':5000/configs', isExternal: false },
                { text: "Status-Überprüfungswebsite", url: 'http://' + host + ':5000/checks', isExternal: false },
                { text: "MagicMirror Konfiguration", url: 'http://' + host + ':8080/remote.html#main-menu', isExternal: true },
                { text: "MagicMirror Remote-Anzeige", url: 'http://' + host + ':8080', isExternal: true },
                { text: "Grafana Website", url: 'http://' + host + ':3000', isExternal: true },
                { text: "phpMyAdmin", url: 'http://' + host + '/phpmyadmin/', isExternal: true }
            ];

            if (!includeHome) {
                links.shift(); // Entfernt die Startseite, wenn includeHome false ist
            }

            links.forEach(function(link) {
                var a = document.createElement('a');
                a.href = link.url;
                a.textContent = link.text;
                if (link.isExternal) {
                    a.target = "_blank"; // Öffnet den Link in einem neuen Fenster/Tab
                }
                menu.appendChild(a);
            });
        }

        function toggleHamburgerMenu() {
            var menu = document.getElementById("hamburgerMenu");
            if (menu.style.display === "block") {
                menu.style.display = "none";
            } else {
                menu.style.display = "block";
            }
        }

        window.onload = function() {
            var mainMenu = document.getElementById("mainMenu");
            var hamburgerMenu = document.getElementById("hamburgerMenu");

            populateLinks(hamburgerMenu, true); // Hamburger-Menü mit Startseite
        };
    </script>

</body>
</html>
